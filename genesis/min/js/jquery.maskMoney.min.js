!function(e){e.fn.maskMoney=function(t){return t=e.extend({symbol:"R$",showSymbol:!1,symbolStay:!1,thousands:",",decimal:".",precision:2,defaultZero:!0,allowZero:!0,allowNegative:!1},t),this.each(function(){function n(e){var n=(e=e||window.event).charCode||e.keyCode||e.which;if(void 0==n)return!1;if(u.attr("readonly")&&13!=n&&9!=n)return!1;if(n<48||n>57)return 45==n?(u.val(function(e){{if(t.allowNegative){e.val();return""!=e.val()&&"-"==e.val().charAt(0)?e.val().replace("-",""):"-"+e.val()}return e.val()}}(u)),!1):43==n?(u.val(u.val().replace("-","")),!1):13==n||9==n||(37==n||39==n||(r(e),!0));if(u.val().length==u.attr("maxlength"))return!1;r(e);var a=String.fromCharCode(n),o=u.get(0),i=u.getInputSelection(o),s=i.start,c=i.end;return o.value=o.value.substring(0,s)+a+o.value.substring(c,o.value.length),l(o,s+1),!1}function a(a){e.browser.msie&&n(a),""==u.val()||u.val()==s(i())||u.val()==t.symbol?t.allowZero?t.symbolStay?u.val(s(i())):u.val(i()):u.val(""):t.symbolStay?t.symbolStay&&u.val()==t.symbol&&u.val(s(i())):u.val(u.val().replace(t.symbol,""))}function r(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function l(e,t){var n=u.val().length;u.val(o(e.value));t-=n-u.val().length,u.setCursorPosition(t)}function o(e){var n=(e=e.replace(t.symbol,"")).length,a="",r="",l="";if(0!=n&&"-"==e.charAt(0)&&(e=e.replace("-",""),t.allowNegative&&(l="-")),0==n){if(!t.defaultZero)return r;r="0.00"}for(var o=0;o<n&&("0"==e.charAt(o)||e.charAt(o)==t.decimal);o++);for(;o<n;o++)-1!="0123456789".indexOf(e.charAt(o))&&(a+=e.charAt(o));var i=parseFloat(a);r=(i=isNaN(i)?0:i/Math.pow(10,t.precision)).toFixed(t.precision),o=0==t.precision?0:1;var u,c=(r=r.split("."))[o].substr(0,t.precision);for(u=(r=r[0]).length;(u-=3)>=1;)r=r.substr(0,u)+t.thousands+r.substr(u);return s(t.precision>0?l+r+t.decimal+c+Array(t.precision+1-c.length).join(0):l+r)}function i(){return(parseFloat("0")/Math.pow(10,t.precision)).toFixed(t.precision).replace(new RegExp("\\.","g"),t.decimal)}function s(e){return t.showSymbol&&e.substr(0,t.symbol.length)!=t.symbol?t.symbol+e:e}var u=e(this);u.bind("keypress.maskMoney",n),u.bind("keydown.maskMoney",function(e){var t=(e=e||window.event).charCode||e.keyCode||e.which;if(void 0==t)return!1;if(u.attr("readonly")&&13!=t&&9!=t)return!1;var n=u.get(0),a=u.getInputSelection(n),o=a.start,i=a.end;return 8==t?(r(e),o==i?(n.value=n.value.substring(0,o-1)+n.value.substring(i,n.value.length),o-=1):n.value=n.value.substring(0,o)+n.value.substring(i,n.value.length),l(n,o),!1):9==t||46!=t&&63272!=t||(r(e),n.selectionStart==n.selectionEnd?n.value=n.value.substring(0,o)+n.value.substring(i+1,n.value.length):n.value=n.value.substring(0,o)+n.value.substring(i,n.value.length),l(n,o),!1)}),u.bind("blur.maskMoney",a),u.bind("focus.maskMoney",function(e){var n=i();if(u.val()==n?u.val(""):""==u.val()&&t.defaultZero?u.val(s(n)):u.val(s(u.val())),this.createTextRange){var a=this.createTextRange();a.collapse(!1),a.select()}}),u.bind("mask",function(){var e=u.val();u.val(o(e))}),u.one("unmaskMoney",function(){u.unbind(".maskMoney"),e.browser.msie?this.onpaste=null:e.browser.mozilla&&this.removeEventListener("input",a,!1)})})},e.fn.unmaskMoney=function(){return this.trigger("unmaskMoney")},e.fn.mask=function(){return this.trigger("mask")},e.fn.setCursorPosition=function(e){return this.each(function(t,n){if(n.setSelectionRange)n.focus(),n.setSelectionRange(e,e);else if(n.createTextRange){var a=n.createTextRange();a.collapse(!0),a.moveEnd("character",e),a.moveStart("character",e),a.select()}}),this},e.fn.getInputSelection=function(e){var t,n,a,r,l,o=0,i=0;return"number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd?(o=e.selectionStart,i=e.selectionEnd):(n=document.selection.createRange())&&n.parentElement()==e&&(r=e.value.length,t=e.value.replace(/\r\n/g,"\n"),(a=e.createTextRange()).moveToBookmark(n.getBookmark()),(l=e.createTextRange()).collapse(!1),a.compareEndPoints("StartToEnd",l)>-1?o=i=r:(o=-a.moveStart("character",-r),o+=t.slice(0,o).split("\n").length-1,a.compareEndPoints("EndToEnd",l)>-1?i=r:(i=-a.moveEnd("character",-r),i+=t.slice(0,i).split("\n").length-1))),{start:o,end:i}}}(jQuery);